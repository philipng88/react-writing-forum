(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{108:function(e,t,a){"use strict";var s=a(0),o=a.n(s);t.a=()=>o.a.createElement("small",{className:"form-text"},o.a.createElement("strong",null,"Tip:")," You can use"," ",o.a.createElement("a",{href:"https://www.markdownguide.org/cheat-sheet/",target:"_blank",rel:"noopener noreferrer"},"markdown")," ","in your post")},247:function(e,t,a){"use strict";a.r(t);var s=a(0),o=a.n(s),l=a(20),n=a(8),r=a(7),u=a(10),c=a(16),i=a(23),d=a(6),m=a.n(d),b=a(14),v=a(21),p=a(108),y=a(13),h=a(19),g=a(46);t.default=Object(n.g)(e=>{const t=Object(s.useContext)(y.a),a=Object(s.useContext)(h.a),d={title:{value:"",hasErrors:!1,message:""},body:{value:"",hasErrors:!1,message:""},isFetching:!0,isSaving:!1,id:Object(n.f)().id,sendCount:0,notFound:!1},[E,k]=Object(l.b)((e,t)=>{switch(t.type){case"fetchComplete":e.title.value=t.value.title,e.body.value=t.value.body,e.isFetching=!1;break;case"titleChange":e.title.hasErrors=!1,e.title.value=t.value;break;case"bodyChange":e.body.hasErrors=!1,e.body.value=t.value;break;case"submitRequest":e.title.hasErrors||e.body.hasErrors||e.sendCount++;break;case"saveRequestStarted":e.isSaving=!0;break;case"saveRequestFinished":e.isSaving=!1;break;case"titleRules":""===t.value.trim()&&(e.title.hasErrors=!0,e.title.message="You must provide a title");break;case"bodyRules":""===t.value.trim()&&(e.body.hasErrors=!0,e.body.message="You must have some post content");break;case"notFound":e.notFound=!0;break;default:throw new Error("Incorrect action type")}},d),{id:f,isFetching:C,isSaving:w,title:{value:F,hasErrors:R,message:S},body:{value:N,hasErrors:j,message:O},sendCount:q,notFound:x}=E,{user:{token:T,username:M}}=t;Object(s.useEffect)(()=>{const t=m.a.CancelToken.source();return(async()=>{try{const s=await m.a.get("/post/"+f,{cancelToken:t.token});s.data?(k({type:"fetchComplete",value:s.data}),M!=s.data.author.username&&(a({type:"flashMessage",value:"You do not have permission to edit that post"}),e.history.push("/"))):k({type:"notFound"})}catch(e){console.log(e.response.data)}})(),()=>t.cancel()},[]),Object(s.useEffect)(()=>{if(q){k({type:"saveRequestStarted"});const e=m.a.CancelToken.source();return(async()=>{try{await m.a.post(`/post/${f}/edit`,{title:F,body:N,token:T},{cancelToken:e.token}),k({type:"saveRequestFinished"}),a({type:"flashMessage",value:"Successfully updated post"})}catch(e){console.log(e.response.data)}})(),()=>e.cancel()}},[q]);return x?o.a.createElement(g.a,null):o.a.createElement(b.a,{title:C?"...":"Edit Post"},C?o.a.createElement(v.a,null):o.a.createElement(u.a,{onSubmit:e=>{e.preventDefault(),k({type:"titleRules",value:F}),k({type:"bodyRules",value:N}),k({type:"submitRequest"})}},o.a.createElement(u.a.Group,null,o.a.createElement(u.a.Label,{htmlFor:"post-title"},"Title"),o.a.createElement(u.a.Control,{type:"text",name:"title",id:"post-title",autoFocus:!0,autoComplete:"off",className:"form-control-title",value:F,onChange:e=>k({type:"titleChange",value:e.target.value}),onBlur:e=>k({type:"titleRules",value:e.target.value})}),R&&o.a.createElement(i.a,{variant:"danger",className:"small liveValidateMessage"},S)),o.a.createElement(u.a.Group,{className:"mb-0"},o.a.createElement(u.a.Label,{htmlFor:"post-body"},"Post"),o.a.createElement(u.a.Control,{as:"textarea",name:"body",id:"post-body",className:"body-content tall-textarea",value:N,onChange:e=>k({type:"bodyChange",value:e.target.value}),onBlur:e=>k({type:"bodyRules",value:e.target.value})}),j&&o.a.createElement(i.a,{variant:"danger",className:"small liveValidateMessage"},O)),o.a.createElement(p.a,null),o.a.createElement("div",{className:"d-block mt-3"},o.a.createElement(r.b,{className:"btn btn-outline-secondary mr-2",to:"/post/"+f},"Go Back"),o.a.createElement(c.a,{variant:"info",type:"submit",disabled:w},w?"Saving...":"Save Changes"))))})}}]);